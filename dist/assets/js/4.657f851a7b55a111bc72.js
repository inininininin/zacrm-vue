webpackJsonp([4],{"5uiz":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mw3O"),n=a.n(i),l=a("zL8q"),o={name:"index",data:function(){return{tiaojian:{secondFrom:"",secondTo:"",telephoneFrom:"",telephoneTo:"",callTimeFrom:"",callTimeTo:"",kw:"",deleted:0,invalidTelephone:0},optionsDeleted:[{value:"",label:"全部"},{value:0,label:"未删除"},{value:1,label:"已删除"}],optionsInvalidTelephone:[{value:"",label:"全部"},{value:0,label:"有效"},{value:1,label:"无效"}],tableData:[],totalNum:0,tableIndexNum:1,templateDataList:[],tempTableIndexNum:1,tempTableIndexNumArr:[1]}},activated:function(){var e=this;$.ajax({url:"/crm/login-refresh",type:"POST",async:!0,success:function(t){0==t.code?(localStorage.setItem("nickname",t.data.nickname),$("#index .peoname").html(t.data.nickname),$("#index #userName").val(t.data.nickname),e.$store.state.loginRefresh=t.data):setTimeout(function(){e.$router.push({path:"/login"})},1e3)}})},created:function(){this.initDataList(1),this.initDataListToTal()},methods:{exitFn:function(){$.ajax({type:"post",url:"/crm/logout",data:"",success:function(e){location.href=location.pathname}})},handleReset:function(){this.tiaojian.secondFrom="",this.tiaojian.secondTo="",this.tiaojian.telephoneFrom="",this.tiaojian.telephoneTo="",this.tiaojian.callTimeFrom="",this.tiaojian.callTimeTo="",this.tiaojian.kw="",this.tiaojian.deleted=0,this.tiaojian.invalidTelephone=0,this.handleQuery()},handleQuery:function(){this.initDataList(1),this.initDataListToTal()},elmentDataStartFn:function(e){!this.tiaojian.callTimeTo||this.moment(e).valueOf()<this.tiaojian.callTimeTo?(this.tiaojian.callTimeFrom=e?this.moment(e).valueOf():"",this.initDataListToTal()):this.$message({type:"info",message:"开始时间需小于结束时间!"})},elmentDataEndFn:function(e){!this.tiaojian.callTimeFrom||this.moment(e).valueOf()>this.tiaojian.callTimeFrom?(this.tiaojian.callTimeTo=e?this.moment(e).valueOf():"",this.initDataListToTal()):this.$message({type:"info",message:"结束时间需大于开始时间!"})},initDataList:function(e){var t=this,a="&"+n.a.stringify({userId:localStorage.getItem("id")||"",secondFrom:this.tiaojian.secondFrom,secondTo:this.tiaojian.secondTo,telephoneFrom:this.tiaojian.telephoneFrom,telephoneTo:this.tiaojian.telephoneTo,callTimeFrom:this.tiaojian.callTimeFrom,callTimeTo:this.tiaojian.callTimeTo,kw:this.tiaojian.kw,deleted:this.tiaojian.deleted,invalidTelephone:this.tiaojian.invalidTelephone});$.ajax({url:"/crm/statistician/phone-record/records",type:"GET",data:"ps=20&pn="+e+a,async:!0,success:function(e){0==e.code&&(t.tableData=e.data.records),t.templateDataList.push({id:t.tableIndexNum,data:e.data.records})}})},initDataListToTal:function(){var e=this,t=n.a.stringify({userId:localStorage.getItem("id")||"",secondFrom:this.tiaojian.secondFrom,secondTo:this.tiaojian.secondTo,telephoneFrom:this.tiaojian.telephoneFrom,telephoneTo:this.tiaojian.telephoneTo,callTimeFrom:this.tiaojian.callTimeFrom,callTimeTo:this.tiaojian.callTimeTo,kw:this.tiaojian.kw,deleted:this.tiaojian.deleted,invalidTelephone:this.tiaojian.invalidTelephone});$.ajax({url:"/crm/statistician/phone-record/records-sum",type:"GET",data:t,async:!0,success:function(t){0==t.code&&(e.totalNum=t.data.count)}})},getDateDiff:function(e){if(!e)return"";var t=(new Date).getTime()-e;if(!(t<0)){var a=t/2592e6,i=t/6048e5,n=t/864e5,l=t/36e5,o=t/6e4;return a>=1?a<=12?parseInt(a)+"月前":parseInt(a/12)+"年前":i>=1?parseInt(i)+"周前":n>=1?parseInt(n)+"天前":l>=1?parseInt(l)+"小时前":o>=1?parseInt(o)+"分钟前":"刚刚"}},handleDel:function(e){var t=this;$.ajax({type:"post",url:"/crm/statistician/phone-record/delete-record?id="+e.phoneRecordId,data:"",success:function(a){0==a.code&&(t.tableData.map(function(a){a.phoneRecordId==e.phoneRecordId&&t.$set(a,"deleted",1)}),l.Message.success("操作成功"))}})},handlerRestore:function(e){var t=this;$.ajax({type:"post",url:"/crm/statistician/phone-record/undo-delete-record?id="+e.phoneRecordId,data:"",success:function(a){0==a.code&&(t.tableData.map(function(a){a.phoneRecordId==e.phoneRecordId&&t.$set(a,"deleted",0)}),l.Message.success("操作成功"))}})},handleCurrentChange:function(e){var t=this;if(this.tableIndexNum=e,this.flag=!1,this.data=[],this.templateDataList.some(function(a){if(a.id==e)return t.data=a.data,t.flag=!0;t.flag=!1}),!this.flag)return this.initDataList(e);this.tableData=this.data},handlePrevClick:function(e){this.tableIndexNum=e,this.initDataList(e)},handleNextClick:function(e){this.tableIndexNum=e,this.initDataList(e)},tableIndex:function(e){return 1==this.tableIndexNum?e+1:(this.tempTableIndexNum=e+20*(this.tableIndexNum-1),e+1+20*(this.tableIndexNum-1))}},watch:{}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"recore-list"}},[a("div",{staticStyle:{padding:"0px 20px",height:"auto"}},[a("h2",{staticStyle:{display:"inline-block",margin:"0","line-height":"70px","font-size":"30px"}},[e._v("\n      "+e._s(e.$store.state.loginRefresh.nickname)+"\n    ")]),e._v(" "),a("a",{staticClass:"loginout",staticStyle:{float:"right","line-height":"70px","margin-left":"20px",cursor:"pointer"},on:{click:e.exitFn}},[e._v("退出登录")])]),e._v(" "),a("div",{attrs:{id:"index"}},[e.$route.query.nickname?a("div",{staticStyle:{width:"100%",height:"auto",padding:"0px 20px"}},[a("h1",{staticStyle:{"font-size":"24px","font-family":"PingFangSC-Regular, PingFang SC","font-weight":"400",color:"rgba(0, 0, 0, 0.85)","line-height":"60px"}},[e._v("\n        昵称："+e._s(e.$route.query.nickname)+"\n      ")])]):e._e(),e._v(" "),a("div",{staticClass:"selectOption",staticStyle:{width:"100%",height:"auto",padding:"0px 20px"}},[a("span",[e._v("筛选条件：")]),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"150px"},attrs:{placeholder:"关键字"},model:{value:e.tiaojian.kw,callback:function(t){e.$set(e.tiaojian,"kw",t)},expression:"tiaojian.kw"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"150px"},attrs:{placeholder:"通话时长From"},model:{value:e.tiaojian.secondFrom,callback:function(t){e.$set(e.tiaojian,"secondFrom",t)},expression:"tiaojian.secondFrom"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"150px"},attrs:{placeholder:"通话时长To"},model:{value:e.tiaojian.secondTo,callback:function(t){e.$set(e.tiaojian,"secondTo",t)},expression:"tiaojian.secondTo"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"150px"},attrs:{placeholder:"主叫号码"},model:{value:e.tiaojian.telephoneFrom,callback:function(t){e.$set(e.tiaojian,"telephoneFrom",t)},expression:"tiaojian.telephoneFrom"}}),e._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"150px"},attrs:{placeholder:"被叫号码"},model:{value:e.tiaojian.telephoneTo,callback:function(t){e.$set(e.tiaojian,"telephoneTo",t)},expression:"tiaojian.telephoneTo"}}),e._v(" "),a("el-date-picker",{attrs:{"default-time":"00:00:00",type:"datetime",placeholder:"请选择通话时间from",align:"right"},on:{change:e.elmentDataStartFn},model:{value:e.tiaojian.callTimeFrom,callback:function(t){e.$set(e.tiaojian,"callTimeFrom",t)},expression:"tiaojian.callTimeFrom"}}),e._v(" "),a("el-date-picker",{attrs:{"default-time":"23:59:59",type:"datetime",placeholder:"选择结束通话时间To",align:"right"},on:{change:e.elmentDataEndFn},model:{value:e.tiaojian.callTimeTo,callback:function(t){e.$set(e.tiaojian,"callTimeTo",t)},expression:"tiaojian.callTimeTo"}}),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tiaojian.deleted,callback:function(t){e.$set(e.tiaojian,"deleted",t)},expression:"tiaojian.deleted"}},e._l(e.optionsDeleted,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tiaojian.invalidTelephone,callback:function(t){e.$set(e.tiaojian,"invalidTelephone",t)},expression:"tiaojian.invalidTelephone"}},e._l(e.optionsInvalidTelephone,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleQuery()}}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:function(t){return e.handleReset()}}},[e._v("重置")])],1),e._v(" "),a("p",{staticClass:"numberAll"},[e._v(e._s("( 共   "+(e.totalNum||0)+"  条数据 )"))]),e._v(" "),a("el-table",{staticStyle:{width:"98%",margin:"0 auto"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{type:"index",index:e.tableIndex,label:"序号",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userNickname",align:"center",label:"所属人姓名",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"telephoneFrom",label:"主叫号码",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"telephoneTo",label:"被叫号码",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"callTime",label:"通话时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.moment(t.row.callTime).format("YYYY-MM-DD HH:mm:ss")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"second",formatter:function(e){return e.second+"s"},label:"通话时长",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"url",label:"录音地址",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.url?a("a",{attrs:{href:t.row.url,target:"＂_blank＂"}},[e._v("录音地址")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.deleted?a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDel(t.row)}}},[e._v("删除")]):e._e(),e._v(" "),1==t.row.deleted?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handlerRestore(t.row)}}},[e._v("恢复")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"page-style",attrs:{background:"",layout:"prev, pager, next",total:e.totalNum},on:{"current-change":e.handleCurrentChange,"prev-click":e.handlePrevClick,"next-click":e.handleNextClick}})],1)])},staticRenderFns:[]};var r=a("VU/8")(o,s,!1,function(e){a("OTJX")},"data-v-379cfdf3",null);t.default=r.exports},OTJX:function(e,t){}});
//# sourceMappingURL=4.657f851a7b55a111bc72.js.map